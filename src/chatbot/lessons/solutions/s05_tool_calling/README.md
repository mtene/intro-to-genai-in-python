# Solution 5: Tool calling

In the solution, we provide the [chatbot](chatbot.py) with a ReAct agent configured with our tools of interest.

## Implementation: ReAct agent setup

```python
def __init__(self):
    llm = LLM()
    tools = [convert_time, convert_currency]
    self._agent = create_react_agent(model=llm, tools=tools)
```

The agent sets up a [`langchain_core.prompts.ChatPromptTemplate`](https://python.langchain.com/api_reference/core/prompts/langchain_core.prompts.chat.ChatPromptTemplate.html) under the hood (we also have the option to provide one), whose role will be apparent later. It also creates its own instance of the given LLM and equips it with tools, via LangChain's [`bind_tools()`](https://docs.langchain.com/oss/python/integrations/chat/openai#chatopenai-bind-tools). As was the case for structured outputs, the original `llm` object remains unmodified and would return free-text responses, as usual, if invoked.

The agent is used as below

```python
@override
def get_answer(self, question: str, ctx: ChatContext) -> str:
    response = self._agent.invoke({"messages": self._chat_history.messages}, config={"callbacks": [ctx]})
    answer = str(response["messages"][-1].content)
```

This is similar to what we've seen in previous exercises, where the `messages` are used to fill in the [`langchain_core.prompts.MessagesPlaceholder`](https://python.langchain.com/api_reference/core/prompts/langchain_core.prompts.chat.MessagesPlaceholder.html) within the agent's de-facto `ChatPromptTemplate`, as mentioned earlier. As usual, providing `ctx` as a callback is optional and does not affect behavior - the agent will use it to push status updates on what tools are called to the UI.

The response contains a list of the messages generated by the agent. They will include any tool calls and results, but usually, only the last one, which gives the final answer, is of interest.

```python
answer = str(response["messages"][-1].content)
```

## Verification

Ask questions involving time or currency conversions and verify that the tools get called by observing the status updates.

üè† [Overview](/README.md) | ‚óÄÔ∏è [Back to exercise](/src/chatbot/lessons/exercises/e05_tool_calling/README.md) | ‚ñ∂Ô∏è [Next exercise](/src/chatbot/lessons/exercises/e06_mcp/README.md)
---|---|---
